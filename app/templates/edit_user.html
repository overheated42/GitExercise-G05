<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Analytics - Admin Dashboard</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  
  <!-- Leaflet CSS & JS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

  <style>
    #map { height: 400px; margin-top: 20px; }
    .card { padding: 20px; margin: 20px; border-radius: 8px; box-shadow: 0 0 5px rgba(0,0,0,0.1); background: #fff; }
  </style>
</head>
<body class="admin">

  <!-- Sidebar -->
  <div class="admin-sidebar">
    <h2 style="text-align:center;">Admin Panel</h2>
    <a href="{{ url_for('admin.dashboard') }}">Dashboard</a>
    <a href="{{ url_for('admin.users') }}">User Management</a>
    <a href="{{ url_for('admin.analytics') }}">Analytics</a>
    <a href="{{ url_for('auth.logout') }}">Logout</a>
  </div>

  <!-- Header -->
  <div class="admin-header">Analytics | MMU Lost in MMU?</div>

<div class="edit-user-container">
    <h2 class="edit-user-title">Edit User</h2>

    <!-- Edit User Form -->
    <form method="POST" action="{{ url_for('admin.edit_user', user_id=user.id) }}" class="edit-user-form">

        <!-- Flash Messages -->
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <ul class="flashes">
                    {% for category, message in messages %}
                        <li class="flash {{ category }}">{{ message }}</li>
                    {% endfor %}
                </ul>
            {% endif %}
        {% endwith %}

        <label for="name">Name</label>
        <input type="text" id="name" name="name" value="{{ user.name }}" placeholder="Enter name" required>

        <label for="username">Username</label>
        <input type="username" id="username" name="username" value="{{ user.username }}" placeholder="Enter username" required>

        <label for="email">Email</label>
        <input type="email" id="email" name="email" value="{{ user.email }}" placeholder="Enter email" required>

        <label for="role">Role</label>
        <select id="role" name="role" required>
            <option value="user" {% if user.role == 'user' %}selected{% endif %}>User</option>
            <option value="admin" {% if user.role == 'admin' %}selected{% endif %}>Admin</option>
        </select>

        <label class="checkbox-label">
            <input type="checkbox" id="is_active" name="is_active" {% if user.is_active %}checked{% endif %}>
            Active
        </label>

        <button type="submit" class="btn btn-primary">Save Changes</button>
    </form>

    <!-- Delete User -->
    <form method="POST" action="{{ url_for('admin.delete_user', user_id=user.id) }}" class="delete-user-form">
        <button type="submit" onclick="return confirm('Are you sure you want to delete this user?');" 
                class="btn btn-danger full-width">
            Delete User
        </button>
    </form>

    <p class="back-link">
        <a href="{{ url_for('admin.dashboard') }}">Back to Admin Dashboard</a>
    </p>
</div>
   
</body>
</html>
